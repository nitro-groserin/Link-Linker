name: Deploy to Firebase Hosting

on:
  push:
    branches:
      - main  # ã¾ãŸã¯ master ãªã©ã€ã‚ãªãŸãŒä½¿ã£ã¦ã„ã‚‹ãƒ–ãƒ©ãƒ³ãƒåã«å¤‰æ›´

jobs:
  build_and_deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4 # 1. GitHubãƒªãƒã‚¸ãƒˆãƒªã®ã‚³ãƒ¼ãƒ‰ã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ

      # --- ğŸš€ ã“ã“ã‹ã‚‰è¿½åŠ ã™ã‚‹ãƒ“ãƒ«ãƒ‰ã‚¹ãƒ†ãƒƒãƒ— ğŸš€ ---
      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20' # ã‚ãªãŸã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«åˆã‚ã›ã¦ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å¤‰æ›´
          
      - name: Install dependencies
        run: npm install
        
      - name: Build project
        run: npm run build # ã¾ãŸã¯ build:production ãªã©ã€ã‚ãªãŸã®package.jsonã«åˆã‚ã›ãŸã‚³ãƒãƒ³ãƒ‰
      # --- ğŸš€ ã“ã“ã¾ã§è¿½åŠ  ğŸš€ ---
      
      - name: Deploy to Firebase # 2. Firebaseãƒ‡ãƒ—ãƒ­ã‚¤ç”¨ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
        uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          repoToken: ${{ secrets.GITHUB_TOKEN }} # GitHubã®ãƒˆãƒ¼ã‚¯ãƒ³
          firebaseServiceAccount: ${{ secrets.FIREBASE_SERVICE_ACCOUNT_LINK_LINKER }} # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«åˆã‚ã›ãŸã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’è‡ªå‹•ã§ä½¿ç”¨
          projectId: link-linker # ğŸ”¥ ã“ã“ã‚’ã‚ãªãŸã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆIDï¼ˆlink-linkerï¼‰ã«è¨­å®š
          channelId: live # liveãƒãƒ£ãƒ³ãƒãƒ«ï¼ˆæœ¬ç•ªç’°å¢ƒï¼‰ã«ãƒ‡ãƒ—ãƒ­ã‚¤



